[["Map",1,2,7,8],"meta::meta",["Map",3,4,5,6],"astro-version","4.16.18","config-digest","8a28d6a84a001a22","blog",["Map",9,10],"eyedropper-for-spectacles-ar-glasses",{"id":9,"data":11,"body":25,"filePath":26,"digest":27,"rendered":28},{"author":12,"pubDatetime":13,"title":14,"draft":15,"tags":16,"ogImage":23,"description":24},"Armand Sumo",["Date","2025-12-15T07:00:00.000Z"],"Eyedropper for Spectacles AR Glasses",false,[17,18,19,20,21,22],"augmented reality","ar","spectacles","lens studio","ui","eyedropper","/assets/eyedropper-for-spectacles-ar-glasses/color_palette_editor_test.gif","Building an eyedropper color picker for Snap Spectacles AR glasses using Lens Studio.","\n\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/color_palette_editor_test.gif\" width=300  alt=\"Eyedropper Test\" >\n\n\n## 1. Why an Eyedropper?\n\nFor the past two weeks, I've been working on an augmented reality assistant for traditional painting; a project that fuses my passions for oil painting and XR. \nAt some point, I needed a way to sample exact colors from my physical palette and bring them into the AR glasses.\nOn desktop, this is handled by the eyedropper, [a tool](https://en.wikipedia.org/wiki/Color_picker) that lets you read a color at a specific point on screen. I wanted to see how this interaction might translate to AR, so I built one in Lens Studio for the 2024 Spectacles.\n\n## 2. Implementation\n\nI read data from the user's camera feed.  \nBecause this feed is quite large, and I was planning to sample a single pixel from it,  I needed to crop it down. Fortunately, the Spectacles Samples provide a project that implements a cropping functionality that I reused here. \n\nAfter the first cropping interaction, an individual pixel might still be too small to be made out by the user. To tackle this issue, I took inspiration from [Figma's eyedropper UI](https://help.figma.com/hc/en-us/articles/27643269375767-Sample-colors-with-the-eyedropper-tool), I implemented a menu containing:\n- a magnified view of a sampled area covered with a grid which represents the pixel samples.\n- an indicator of the sampled pixel's color.\n\nBoth update in real-time, as the user hovers on the crop area's surface.\n\n## 3. UI and Materials\n\nThe recently released Spectacles UI Kit took care of many of the key UI elements. This allowed me to focus my attention on bespoke materials for rectangle corners and grids.\nMy prior 3D development experience involves lots of Three.js, where you'll usually write shaders inline with JavaScript or TypeScript code. As a result, when using Lens Studio I find myself leaning towards writing shader code rather than wrangling material graph nodes. \nFor this reason, I've prioritized the use of The Material Graph Editor's Custom Code Nodes.\n\nBelow is a screenshot of Procedural Grid's Material Graph and a snippet of shader code.\n\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/texture_grid_material_editor.png\" width=1000  alt=\"Texture Grid Material Editor\">\n\nThe logic for reading and displaying colors is handled by a CropAreaSelector class. I've included some of its core methods below; they showcase ProceduralTextureProvider and [getPixels()](https://developers.snap.com/lens-studio/api/lens-scripting/classes/Built-In.ProceduralTextureProvider.html#getpixels), which are useful for reading and writing pixel data to textures.\n\n## 4. Security Considerations\n\nNote that the getPixels API is [restricted](https://developers.snap.com/lens-studio/features/remote-apis/remote-service-module) when using the Remote Service Module.\nAs a result, it might prompt a user authorization screen when launching the lens.\nHence, I've also implemented a version that sends the image directly to a Multimodal Large Language Model to extract the color pigment. \n\nThis initially perplexed me: you can send camera textures to a remote server but you can't read pixel values locally? \nThe rationale, as best I can understand it is that if you can read pixels locally, you could extract sensitive information (Credit Card data, facial recognition, etc.) and exfiltrate it through innocuous-looking API calls without the user's knowledge. By restricting local pixel access when remote services are enabled, Snap ensures that if any image analysis happens, either:\n- it stays entirely on-device (no remote module), or\n- the user is explicitly warned that data is leaving the device (remote module triggers authorization prompt)\n\n\n\n## 5. Comfort and ease of use\n\nWhen testing the Eyedropper on Spectacles, I noticed that mid-air and fine-grained movements don't really go hand in hand.\nSomething I've taken for granted from desktop use is that tactile interaction, where the user applies pressure on a surface, results in a tangent friction force. This friction force stabilizes their hand trajectories, both in position and speed.\n\nIt is precisely this trajectory stabilization which enables finer-grained movement. \nThis is not something that can be reproduced through [filtering](https://github.com/casiez/OneEuroFilter), because filtering causes spatial information loss. Friction on the other hand guides movement towards more stable dynamics without causing information loss.\n\nUpon observing this, I felt tempted to drop physical interaction in favor of the most convenient user experience of all: querying a multimodal AI model.\n\nI called a Gemini model to segment palette color blobs and extract pigments from each. Then I actually didn't bother segmenting and simply sent the entire image to a Gemini model and the results were equivalent. \n\nThis would've been unthinkable 5 years ago, but because tech evolves at an exponential pace, 5 years is actually... kind of an eternity.\n\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/plein-air-Celeste-Bergin.jpg\" width=400  alt=\"Gemini Call Input\">\n\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/gemini_call_result.png\" width=400  alt=\"Gemini Call Result\">\n\n\nNow, though the extracted pigments aren't necessarily found in the input image, it provides enough perceptual accuracy for the user to accomplish their goal. After all, the domain we're tackling is traditional painting and not professional color grading. \n\nIn the end, I will make both interaction modes available for the user to choose: \n- one that is deterministic and over which they have complete control.\n- another that is probabilistic and where the user yields a lot of control.\n\nThere's another factor to consider: every time the user performs a manual action, they execute \"intentional\" timesteps that get stored in procedural memory. This engages multiple brain areas and reinforces learning. When querying AI models, users invest effort in formulating intent through natural language, but the embodied component is largely absent. I'd love to hear thoughts on interaction modes that combine the advantages of both approaches.\n\n## 6. Code Snippets and References\n\u003Cdetails>\n\u003Csummary>Procedural Grid Custom Code Node\u003C/summary>\n\n```glsl\ninput_float gridCountX;\ninput_float gridCountY;\ninput_float strokeWidth;\ninput_float softness;\ninput_float feather;\ninput_vec4 gridColor;\ninput_vec2 surfaceUVCoords;\ninput_vec3 surfaceWorldScale;\ninput_vec2 uvOffset;\n\noutput_vec4 Output;\n\nvoid main()\n{\n    float aspect = surfaceWorldScale.x / surfaceWorldScale.y;\n    \n    vec2 p = surfaceUVCoords - uvOffset;\n    vec2 pNorm = vec2(p.x, p.y / aspect);\n    vec2 pShifted = pNorm + 0.5;\n    \n    float halfStroke = strokeWidth * 0.5;\n    float gridMask = 0.0;\n    \n    for (float i = 1.0; i \u003C= gridCountX - 1.0; i += 1.0) {\n        float lineX = i / gridCountX;\n        float distToLine = abs(pShifted.x - lineX);\n        float lineMask = 1.0 - smoothstep(halfStroke - softness, halfStroke + softness + feather, distToLine);\n        gridMask = max(gridMask, lineMask);\n    }\n    \n    for (float j = 1.0; j \u003C= gridCountY  - 1.0; j += 1.0) {\n        float lineY = j / gridCountY;\n        float distToLine = abs(pShifted.y - lineY);\n        float lineMask = 1.0 - smoothstep(halfStroke - softness, halfStroke + softness + feather, distToLine);\n        gridMask = max(gridMask, lineMask);\n    }\n    \n    Output = gridColor * gridMask;\n}\n```\n\u003C/details>\n\u003Cdetails>\n\u003Csummary> CropAreaSelector Methods \u003C/summary>\n\n\nThe code for this ongoing project is available on a [fork](https://github.com/a-sumo/Spectacles-Sample/tree/11a3183fc281a9e3720ea87920d9006c8ecb3195/Crop) of Snap's official Spectacles Samples repository. \n\n```ts\nprivate updateCropArea(localPosition: vec2): void {\n    if (!this.screenCropProvider || !this.cropAreaMaterial) {\n        return;\n    }\n\n    const gridSize = this._validatedGridScale;\n    const halfGrid = Math.floor(gridSize / 2);\n\n    const centerPixel = this.localToPixelCoords(localPosition);\n    const startPixel = this.clampCropRegion(centerPixel, gridSize, halfGrid);\n\n    const croppedPixels = this.sampleCroppedPixels(startPixel, gridSize);\n    this.updateCropAreaTexture(croppedPixels, gridSize);\n    this.updateSelectedColor(croppedPixels, gridSize, halfGrid);\n    this.resetSelectionToCenter();\n\n    this._onCropAreaChangedEvent.invoke();\n}\n\nprivate localToPixelCoords(localPosition: vec2): vec2 {\n    return new vec2(\n        Math.round((localPosition.x + 0.5) * (this.screenCropWidth - 1)),\n        Math.round((localPosition.y + 0.5) * (this.screenCropHeight - 1))\n    );\n}\n\nprivate clampCropRegion(centerPixel: vec2, gridSize: number, halfGrid: number): vec2 {\n    return new vec2(\n        Math.max(0, Math.min(this.screenCropWidth - gridSize, centerPixel.x - halfGrid)),\n        Math.max(0, Math.min(this.screenCropHeight - gridSize, centerPixel.y - halfGrid))\n    );\n}\n\nprivate sampleCroppedPixels(startPixel: vec2, gridSize: number): Uint8Array {\n    const pixelBuffer = new Uint8Array(gridSize * gridSize * 4);\n    this.screenCropProvider.getPixels(\n        startPixel.x,\n        startPixel.y,\n        gridSize,\n        gridSize,\n        pixelBuffer\n    );\n    return pixelBuffer;\n}\n\nprivate updateCropAreaTexture(croppedPixels: Uint8Array, gridSize: number): void {\n    const cropAreaTexture = ProceduralTextureProvider.createWithFormat(\n        gridSize,\n        gridSize,\n        TextureFormat.RGBA8Unorm\n    );\n    const texProvider = cropAreaTexture.control as ProceduralTextureProvider;\n    texProvider.setPixels(0, 0, gridSize, gridSize, croppedPixels);\n\n    this.cropAreaMaterial.mainTexture = cropAreaTexture;\n}\n\nprivate updateSelectedColor(croppedPixels: Uint8Array, gridSize: number, halfGrid: number): void {\n    const centerPixelIndex = halfGrid * gridSize + halfGrid;\n    const i = centerPixelIndex * 4;\n\n    const color = new vec4(\n        croppedPixels[i] * ONE_OVER_255,\n        croppedPixels[i + 1] * ONE_OVER_255,\n        croppedPixels[i + 2] * ONE_OVER_255,\n        1.0\n    );\n\n    this.selectedColorMaterial.baseColor = color;\n}\n```\n\u003C/details>\n\n## Up next: Computing and Visualizing Color Spaces in Augmented Reality\n","src/content/blog/eyedropper-for-spectacles-ar-glasses.md","ee2bfa6ce5884662",{"html":29,"metadata":30},"\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/color_palette_editor_test.gif\" width=\"300\" alt=\"Eyedropper Test\">\n\u003Ch2 id=\"1-why-an-eyedropper\">1. Why an Eyedropper?\u003C/h2>\n\u003Cp>For the past two weeks, I’ve been working on an augmented reality assistant for traditional painting; a project that fuses my passions for oil painting and XR.\nAt some point, I needed a way to sample exact colors from my physical palette and bring them into the AR glasses.\nOn desktop, this is handled by the eyedropper, \u003Ca href=\"https://en.wikipedia.org/wiki/Color_picker\">a tool\u003C/a> that lets you read a color at a specific point on screen. I wanted to see how this interaction might translate to AR, so I built one in Lens Studio for the 2024 Spectacles.\u003C/p>\n\u003Ch2 id=\"2-implementation\">2. Implementation\u003C/h2>\n\u003Cp>I read data from the user’s camera feed.\u003Cbr>\nBecause this feed is quite large, and I was planning to sample a single pixel from it,  I needed to crop it down. Fortunately, the Spectacles Samples provide a project that implements a cropping functionality that I reused here.\u003C/p>\n\u003Cp>After the first cropping interaction, an individual pixel might still be too small to be made out by the user. To tackle this issue, I took inspiration from \u003Ca href=\"https://help.figma.com/hc/en-us/articles/27643269375767-Sample-colors-with-the-eyedropper-tool\">Figma’s eyedropper UI\u003C/a>, I implemented a menu containing:\u003C/p>\n\u003Cul>\n\u003Cli>a magnified view of a sampled area covered with a grid which represents the pixel samples.\u003C/li>\n\u003Cli>an indicator of the sampled pixel’s color.\u003C/li>\n\u003C/ul>\n\u003Cp>Both update in real-time, as the user hovers on the crop area’s surface.\u003C/p>\n\u003Ch2 id=\"3-ui-and-materials\">3. UI and Materials\u003C/h2>\n\u003Cp>The recently released Spectacles UI Kit took care of many of the key UI elements. This allowed me to focus my attention on bespoke materials for rectangle corners and grids.\nMy prior 3D development experience involves lots of Three.js, where you’ll usually write shaders inline with JavaScript or TypeScript code. As a result, when using Lens Studio I find myself leaning towards writing shader code rather than wrangling material graph nodes.\nFor this reason, I’ve prioritized the use of The Material Graph Editor’s Custom Code Nodes.\u003C/p>\n\u003Cp>Below is a screenshot of Procedural Grid’s Material Graph and a snippet of shader code.\n\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/texture_grid_material_editor.png\" width=\"1000\" alt=\"Texture Grid Material Editor\">\u003C/p>\n\u003Cp>The logic for reading and displaying colors is handled by a CropAreaSelector class. I’ve included some of its core methods below; they showcase ProceduralTextureProvider and \u003Ca href=\"https://developers.snap.com/lens-studio/api/lens-scripting/classes/Built-In.ProceduralTextureProvider.html#getpixels\">getPixels()\u003C/a>, which are useful for reading and writing pixel data to textures.\u003C/p>\n\u003Ch2 id=\"4-security-considerations\">4. Security Considerations\u003C/h2>\n\u003Cp>Note that the getPixels API is \u003Ca href=\"https://developers.snap.com/lens-studio/features/remote-apis/remote-service-module\">restricted\u003C/a> when using the Remote Service Module.\nAs a result, it might prompt a user authorization screen when launching the lens.\nHence, I’ve also implemented a version that sends the image directly to a Multimodal Large Language Model to extract the color pigment.\u003C/p>\n\u003Cp>This initially perplexed me: you can send camera textures to a remote server but you can’t read pixel values locally?\nThe rationale, as best I can understand it is that if you can read pixels locally, you could extract sensitive information (Credit Card data, facial recognition, etc.) and exfiltrate it through innocuous-looking API calls without the user’s knowledge. By restricting local pixel access when remote services are enabled, Snap ensures that if any image analysis happens, either:\u003C/p>\n\u003Cul>\n\u003Cli>it stays entirely on-device (no remote module), or\u003C/li>\n\u003Cli>the user is explicitly warned that data is leaving the device (remote module triggers authorization prompt)\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"5-comfort-and-ease-of-use\">5. Comfort and ease of use\u003C/h2>\n\u003Cp>When testing the Eyedropper on Spectacles, I noticed that mid-air and fine-grained movements don’t really go hand in hand.\nSomething I’ve taken for granted from desktop use is that tactile interaction, where the user applies pressure on a surface, results in a tangent friction force. This friction force stabilizes their hand trajectories, both in position and speed.\u003C/p>\n\u003Cp>It is precisely this trajectory stabilization which enables finer-grained movement.\nThis is not something that can be reproduced through \u003Ca href=\"https://github.com/casiez/OneEuroFilter\">filtering\u003C/a>, because filtering causes spatial information loss. Friction on the other hand guides movement towards more stable dynamics without causing information loss.\u003C/p>\n\u003Cp>Upon observing this, I felt tempted to drop physical interaction in favor of the most convenient user experience of all: querying a multimodal AI model.\u003C/p>\n\u003Cp>I called a Gemini model to segment palette color blobs and extract pigments from each. Then I actually didn’t bother segmenting and simply sent the entire image to a Gemini model and the results were equivalent.\u003C/p>\n\u003Cp>This would’ve been unthinkable 5 years ago, but because tech evolves at an exponential pace, 5 years is actually… kind of an eternity.\n\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/plein-air-Celeste-Bergin.jpg\" width=\"400\" alt=\"Gemini Call Input\">\n\u003Cimg src=\"/assets/eyedropper-for-spectacles-ar-glasses/gemini_call_result.png\" width=\"400\" alt=\"Gemini Call Result\">\u003C/p>\n\u003Cp>Now, though the extracted pigments aren’t necessarily found in the input image, it provides enough perceptual accuracy for the user to accomplish their goal. After all, the domain we’re tackling is traditional painting and not professional color grading.\u003C/p>\n\u003Cp>In the end, I will make both interaction modes available for the user to choose:\u003C/p>\n\u003Cul>\n\u003Cli>one that is deterministic and over which they have complete control.\u003C/li>\n\u003Cli>another that is probabilistic and where the user yields a lot of control.\u003C/li>\n\u003C/ul>\n\u003Cp>There’s another factor to consider: every time the user performs a manual action, they execute “intentional” timesteps that get stored in procedural memory. This engages multiple brain areas and reinforces learning. When querying AI models, users invest effort in formulating intent through natural language, but the embodied component is largely absent. I’d love to hear thoughts on interaction modes that combine the advantages of both approaches.\u003C/p>\n\u003Ch2 id=\"6-code-snippets-and-references\">6. Code Snippets and References\u003C/h2>\n\u003Cdetails>\n\u003Csummary>Procedural Grid Custom Code Node\u003C/summary>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"glsl\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_float gridCountX;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_float gridCountY;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_float strokeWidth;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_float softness;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_float feather;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_vec4 gridColor;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_vec2 surfaceUVCoords;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_vec3 surfaceWorldScale;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">input_vec2 uvOffset;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">output_vec4 Output;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> main\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> aspect \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> surfaceWorldScale\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">x\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> /\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> surfaceWorldScale\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">y\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    vec2 p \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> surfaceUVCoords \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">-\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> uvOffset;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    vec2 pNorm \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> vec2\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">p\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> p\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">y\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> /\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> aspect)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    vec2 pShifted \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pNorm \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0.5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> halfStroke \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> strokeWidth \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0.5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridMask \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0.0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">; i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridCountX \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">; i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> lineX \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">/\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridCountX;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> distToLine \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> abs\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">pShifted\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">x\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> -\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> lineX)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> lineMask \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> -\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> smoothstep\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(halfStroke \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">-\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> softness\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> halfStroke \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">+\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> softness \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">+\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> feather\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> distToLine)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        gridMask \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> max\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(gridMask\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> lineMask)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> j \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">; j \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridCountY  \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">; j \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> lineY \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> j \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">/\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridCountY;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> distToLine \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> abs\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">pShifted\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">y\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> -\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> lineY)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        float\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> lineMask \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1.0\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> -\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> smoothstep\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(halfStroke \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">-\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> softness\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> halfStroke \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">+\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> softness \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">+\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> feather\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> distToLine)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        gridMask \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> max\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(gridMask\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> lineMask)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    Output \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridColor \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridMask;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003C/details>\n\u003Cdetails>\n\u003Csummary> CropAreaSelector Methods \u003C/summary>\n\u003Cp>The code for this ongoing project is available on a \u003Ca href=\"https://github.com/a-sumo/Spectacles-Sample/tree/11a3183fc281a9e3720ea87920d9006c8ecb3195/Crop\">fork\u003C/a> of Snap’s official Spectacles Samples repository.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"ts\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">private \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">updateCropArea\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(localPosition: vec2): \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">void\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">!\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">screenCropProvider\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ||\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> !\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">cropAreaMaterial\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> gridSize\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic\"> this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic\">_validatedGridScale\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> halfGrid\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> Math\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">floor\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">gridSize\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> /\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> centerPixel\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic\"> this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">localToPixelCoords\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">localPosition\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> startPixel\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic\"> this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">clampCropRegion\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">centerPixel\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> halfGrid\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> croppedPixels\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic\"> this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">sampleCroppedPixels\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">startPixel\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> gridSize\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">    this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">updateCropAreaTexture\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(croppedPixels\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">    this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">updateSelectedColor\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(croppedPixels\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> halfGrid);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">    this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">resetSelectionToCenter\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">    this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">_onCropAreaChangedEvent\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">invoke\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">private \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">localToPixelCoords\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(localPosition: vec2): vec2 {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> vec2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">        Math\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">round\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">((\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">localPosition\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">x\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0.5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">screenCropWidth\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">        Math\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">round\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">((\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">localPosition\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">y\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0.5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">screenCropHeight\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">private \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">clampCropRegion\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(centerPixel: vec2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize: number\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> halfGrid: number): vec2 {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> vec2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">        Math\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">max\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\"> Math\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">min\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">screenCropWidth\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\"> centerPixel\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">x\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> halfGrid))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">        Math\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">max\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\"> Math\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">min\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">screenCropHeight\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\"> centerPixel\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">y\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> halfGrid))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">private \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">sampleCroppedPixels\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(startPixel: vec2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize: number): Uint8Array {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> pixelBuffer\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> Uint8Array\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">gridSize\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> gridSize\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 4\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">    this\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">screenCropProvider\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getPixels\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">        startPixel\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">        startPixel\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">y\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        pixelBuffer\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pixelBuffer;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">private \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">updateCropAreaTexture\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(croppedPixels: Uint8Array\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize: number): \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">void\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> cropAreaTexture\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> ProceduralTextureProvider\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">createWithFormat\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">        gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">        gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">        TextureFormat\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic\">RGBA8Unorm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> texProvider\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> cropAreaTexture\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic\">control\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> as\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic\"> ProceduralTextureProvider\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#D6DEEB\">    texProvider\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setPixels\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> croppedPixels);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">    this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">cropAreaMaterial\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">mainTexture\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> cropAreaTexture;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">private \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">updateSelectedColor\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(croppedPixels: Uint8Array\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gridSize: number\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> halfGrid: number): \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">void\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> centerPixelIndex\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> halfGrid\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> gridSize\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> halfGrid\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> i\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> centerPixelIndex\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 4\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> color\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> vec4\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">        croppedPixels\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">i\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> ONE_OVER_255\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">        croppedPixels\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> ONE_OVER_255\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">        croppedPixels\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> ONE_OVER_255\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">        1.0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">    this\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">selectedColorMaterial\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#BAEBE2\">baseColor\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> color;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003C/details>\n\u003Ch2 id=\"up-next-computing-and-visualizing-color-spaces-in-augmented-reality\">Up next: Computing and Visualizing Color Spaces in Augmented Reality\u003C/h2>",{"headings":31,"imagePaths":54,"frontmatter":11},[32,36,39,42,45,48,51],{"depth":33,"slug":34,"text":35},2,"1-why-an-eyedropper","1. Why an Eyedropper?",{"depth":33,"slug":37,"text":38},"2-implementation","2. Implementation",{"depth":33,"slug":40,"text":41},"3-ui-and-materials","3. UI and Materials",{"depth":33,"slug":43,"text":44},"4-security-considerations","4. Security Considerations",{"depth":33,"slug":46,"text":47},"5-comfort-and-ease-of-use","5. Comfort and ease of use",{"depth":33,"slug":49,"text":50},"6-code-snippets-and-references","6. Code Snippets and References",{"depth":33,"slug":52,"text":53},"up-next-computing-and-visualizing-color-spaces-in-augmented-reality","Up next: Computing and Visualizing Color Spaces in Augmented Reality",[]]